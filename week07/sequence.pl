#! /usr/bin/perl

use strict;
use warnings;

use DBI;

my $dbfile = "sequence.db";

# CREATE TABLE gene (
# gene_id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
# organism_id INTEGER NOT NULL,
# gene_name VARCHAR(255),
# gene_sequence TEXT,
# expression_level INTEGER,
# start INTEGER,
# stop INTEGER
# );
# CREATE TABLE organism (
# organism_id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
# organism_name VARCHAR(255),
# tissue VARCHAR(255) 
# );

my $dsn = "dbi:SQLite:dbname=$dbfile";
my $dbh = DBI->connect($dsn, "", "",  {
	PrintError	=> 0,
	RaiseError	=> 1,} );

my @records = ( ['1', 'Bos taurus', 'retinal pigment epithelium' ], ['2', 'Bos taurus', 'retinal pigment epithelium' ] );
my $query = "INSERT INTO organism (organism_id, organism_name, tissue) VALUES (?, ?, ?)";
my $sth = $dbh->prepare($query);

foreach my $rec (@records) {
	$sth->execute( @$rec );
}

my $fsequence = '
CTTGCTCAGTCCACAGTTGGTGCCAGAACTCTCAATCCTCTACTGAGAGAAAATGTCCAGCCAAGTTGAA
CATCCAGCTGGTGGTTACAAGAAACTGTTTGAAACTGTGGAGGAACTATCCTCACCGCTCACAGCCCATG
TTACAGGCAGGATCCCCCTCTGGCTAACCGGCAGTCTCCTTCGATGTGGGCCAGGACTCTTTGAGGTTGG
ATCGGAACCATTTTACCACCTGTTTGATGGGCAAGCCCTCCTACACAAGTTTGACTTTAAAGAAGGACAT
GTCACATACCACAGAAGGTTCATCCGCACTGATGCTTACGTACGGGCAATGACTGAGAAAAGGATCGTCA
TAACAGAATTTGGCACCTGTGCTTTCCCAGATCCCTGCAAGAATATATTTTCCAGGTTTTTTTCTTACTT
CCGAGGAGTGGAGGTTACTGACAATGCCCTTGTTAATATCTACCCAGTGGGGGAAGATTACTATGCCTGC
ACAGAGACCAACTTCATTACAAAGGTTAATCCTGAGACCTTGGAAACAATTAAGCAGGTTGACCTTTGCA
ACTATGTCTCAGTCAATGGAGCCACTGCTCACCCCCACATTGAAAATGATGGGACTGTTTACAACATTGG
TAATTGCTTTGGGAAAAATTTTTCAATTGCCTACAATATTGTAAAGATCCCACCACTACAAGCAGACAAG
GAAGATCCAATAAGCAAGTCAGAGATCGTTGTACAATTCCCCTGCAGTGACCGATTCAAGCCATCTTACG
TCCATAGTTTTGGTTTGACTCCCAACTATATTGTTTTTGTGGAGACACCAGTCAAAATTAATCTGTTCAA
GTTTCTTTCTTCATGGAGTCTTTGGGGAGCCAATTACATGGATTGTTTTGAATCCAATGAAACCATGGGG
GTTTGGCTTCATATTGCTGACAAAAAAAGAAAAAAGTATATCAATAATAAATACAGGACCTCTCCTTTTA
ACCTCTTTCATCACATCAATACCTATGAAGACCATGAGTTTCTGATTGTGGATCTCTGTTGCTGGAAAGG
ATTTGAATTTGTTTATAATTATTCATATTTAGCCAATTTACGTGAGAACTGGGAAGAGGTGAAAAAAAAT
GCCAGAAAGGCTCCTCAGCCTGAAGTTAGGAGATACGTACTTCCTTTGAATATTGACAAGGCTGACACAG
GCAAGAATTTAGTCACACTCCCCAACACAACTGCCACTGCAATTCTGTGCAGTGACGAGACCATCTGGCT
GGAACCTGAGGTTCTCTTTTCAGGGCCTCGCCAAGCATTTGAGTTTCCTCAAATCAATTACCAGAAGTAT
GGTGGGAAACCTTACACATATGCATATGGACTTGGCTTGAATCACTTTGTTCCAGACAGGCTCTGTAAGC
TGAACGTCAAAACTAAAGAAACCTGGGTATGGCAAGAGCCTGATTCATACCCCTCAGAACCTATCTTTGT
TTCTCACCCAGATGCCTTGGAGGAAGATGACGGTGTAGTTCTGAGTGTGGTGGTGAGCCCTGGGGCAGGA
CAAAAGCCTGCTTATCTTCTGATTCTGAATGCCAAGGACTTGAGTGAAGTTGCCAGGGCTGAAGTGGAGA
TTAACATCCCCGTCACCTTTCATGGACTGTTCAAAAAATCCTGAGCACATTCTAGCATGACATGTTTCTG
GTGACAAAACACAGAGAAACGTAGTTAGGTCTGCAATCAAATTCTGTTTAGCTTTAGCCTGCTGTCTATA
AGGGTTTTAACTTGCAGATGCACACCGTTTTGCAGTATTTTACAGAAAGCACAGAGTTGAGTAAGGAATT
CCTTTTAAAAAAGTGCTTATTTAGATAATCGTACTTCGTGAGACAGGCACATCATAACTAAAAACTCTTT
ATATATTTACAATCAAATAGAAAATGAATGTGAATTTATTAAACTGTTTTTCATTCCTATTATAAAAGTG
TATTTTAGGCACCCATCTACTCCTATTACTTTTTAACATTTAAAAGCCAAAGTCCTCTACAGCTGATATG
TATATAGCTTTGCTGTGTCAAGGCAGCATCTTGGAAAAAGGCTTAGTTACTAAATGTCAAATCAAACTTC
TTCTCAAACCAGGGACTTTGATCTAAGACAATCATTGTAATTGTATGCACATATGTATTATTATTCAAAG
ATTCTCATGGTTTAAACTTTAATATTTCCATTTAATATAGGCAATTATTACTATTTCTGATTTCACAGTA
AGGAAGCCTGTTTCTAAGTCACTGAGGGCTGTCAACCAAATACCTTCTCAGAGATTACATTATCTATTAG
AAACTTATATAACATAAAAGCAATTACATATAGTAGTGACTATTTTTTTTAAATAGCATAAAATACTTAC
AAACATAATTGCTGTTTAAAATCAGATTATGGGGATAATAATGTGTATGGGGGGGGTTATACTTTGTTGC
CTCTTCTGCTTAATTACATTTAAGCACTGTGCACCTGACTGAAGAGAAAATGAGAAAATAGAAAATACTG
TCATTAATGTTCAGATATGAATATAGTTTAAGCACTTTTGTTTTTAAAATTATTCTTTTCTGAGATACAT
GTTGCAAAAAAAAATGAAGATTGACAAAAATTTTTATTCTATATCTTAATCCTGTTTGACTAAGTAAAAA
CAGCTTGAAGGAACAGACTGACTTGGGTACTTGATGCATCCATTTGATTTCTTTATTTAGATAAAATGCA
AACTCATTTTTTAAGATTATAAGTACTCATTAAAATATACTTTTCAAAGAAAATCTAAAATTGCAAAAAA
CAGAAATTATAAAGTAAAATCATACAGAGCTCATCTAAGCACAACTACTGGTCTTTTCCATCATTTCCCA
TGTGTGGCTTTTTAATGTAATCATTATTTCTTTGGGAGTAATTCCTAGGTAAACCTAGATATCTCAAAAA
AAAAAAAAAAGAAAAATGCCATAAAATAACATGGAAAATGTGACTGTAGATAAACATCAATCTGCTGGAT
TTTGTCTCTAGATGTGGCACGTGAACTTAATTCCACAAAGAAAGCTATTCATACATTTATTTTAAAAATG
CAAAAAATAAATTACTGAATAATTACCTAAAAAAA';
my $ssequence = '
AGAGATCCCAAGCCCTCGCAGTGCCATCTGAAGGGAGGGAGATGTAAAGGAAGCTGCAGGGAGGGAAGAC
AAGGAGTGGCCAAGAGCAGTCCCTGAACACGGACGAGCATCGCTCTCGCTCAGAGCCCTGCACAATGGAA
ATAATATTTGGCAGAAATAAGAAGGAGCAACTGGAGCCTGTGAGGGCCAGAGTAACAGGCAAGATTCCAG
CCTGGCTGCAGGGGATCCTGCTCCGCAATGGGCCTGGGATGCACACGGTGGGCGAGACCAGATACAACCA
CTGGTTCGATGGCCTGGCCTTGCTCCACAGCTTCACCATCAGAGATGGTGAAGTCTACTACAGGAGCAAA
TACCTGAGAAGTGATACCTACACTGCCAACATCGAAGCAAACAGGATTGTGGTGTCAGAATTCGGAACAA
TGGCCTATCCAGACCCCTGCAAAAACATATTTTCCAAAGCTTTCTCCTACCTGTCCCACACTATCCCCGA
TTTCACAGACAACTGTCTGATCAACATCAGGAGGTGCGGAGAAGACTTCTACGCGACCACAGAGACCAGT
TACATCAGGAGGATCAACCCCCAGACCCTGGAAACCCTGGAGAAGGTTGATTTTCGTAAATATGTGGCTG
TAAATCTGGCAACTTCACATCCTCACTACGACGCTGCTGGAAATGTTCTCAATGTTGGCACGTCCATCGT
GGACAAGGGGAAGACAAAATACGTGATCTTTAAGATCCCTGCCCCAGTCCCAGGGGGCAGGAAGGAGGGC
CGGAGCCCCCTGAAGGACACGGAGGTCTTCTGCTCCATCGCCGCCCACTCCCTCCTCTCCCCGAGCTATT
ACCACAGCTTCGGAGTCAGCGAGAACTACATCATTTTCCTCGAGCAGCCTTTCAAGTTGGACATCCTCAA
GATGGCCACGGCTTACATTCGGGGTGTGAGCTGGGCTTCCTGCCTGGCCTTCCACGGGGAGGACAAGACT
CACATCCACATCATCGACCGAAGGACGCGGAAGCCCGTGCCGACCAAGTATCACACGGACCCCATGGTGG
TATTTCACCACGTCAATGCCTACGAGGAGGACGGCTGCCTCCTGTTCGATGTCATCACCTACGAGGACGG
CAGCCTCTACCAGCTCTTCTACTTGGCCAACCTGAACGAGGACTTTAAGGAGAACTCCAGGCTCACCTCC
ATGCCCACCCTCAAGAGGTTCGTGCTTCCCCTCCACGTGGACAAGAATGCAGAAGTGGGCTCCAATTTAA
TCAAACTGTCGTCTACAACAGCACGAGCCCTAAAGGAAAAAGATGACCAGGTCTACTGTCAGCCGGAGTT
GCTCTGTGAAGGCTTAGAACTGCCTCACATCAATTATGCCCACAATGGGCAGCCATACCGCTATATCTTT
GCTGCTGGAGTCCAGTGGAGCCCTAGGCCATTGATTTACGCCGCGATTCGCCTTGCCAAGTCCTCCTTGA
CGTGGAAAGAGGAGCACTGCTGGCCGGCGGAGCCCCTGTTCGTGCCCACACCAGGTGCCAAGGACGAGGA
TGATGGGATTATCTTATCGGCCATAGTCTCTACCGATCCCCAGAAGTCGCCTTTTCTGCTGGTTCTCGAT
GCCAGAACTTTTACGGAACTGGCCCGCGCGTCCGTCGATGTGGAGATGCACCTGGATTTCCACGGGCTGT
TCATCCCAGATGCAGGCAGGGACCCGGGGAAGCAGGCCCCTTCCCAGGAGGCGCCGGCCAGGGCTGCCGC
CGGACGTGCGGCCCCAAGAACTGACAGCCTGGAGGCTTTGGTCCTGGGGACCAGCTCCGCCCAGCTCACG
GCTGTCCCCGCCCCGGGGGAAGGGCGGGAGAGTGGTCCTTCGTTCCATTTCGCACATATTCTTTCCGCAG
CTGCTTTGAGTCAAAATTCTGAAACGGAAACATAAGTGCGAATCGATGTGTATCTTTTCTTGGCGAATCT
TTTGGCCGTGAGGACTATCCTTGACTGAGGTTAATATTACTTGGCTAATCTGGCCTACTCTAGCGCTGGT
AGAAGTCTCGGTGCATTCCACAAAACACCGGAACTAACGTAGCCGGGGCCAAGATGATATATTATCGTGG
CCGCCTTCTGGAAACTGCCCGGAAACCGGC';

my @srecords = ( [ '1', '1', 'RPE65', $fsequence, '1094010','53', '1654'], [ '2', '2', 'BCO1', $ssequence, '6956', '135', '1925'] );
my $squery = "INSERT INTO gene (gene_id, organism_id, gene_name, gene_sequence, expression_level, start, stop) VALUES (?, ?, ?, ?, ?, ?, ?)";
my $ssth = $dbh->prepare($squery);
foreach my $srec (@srecords) {
	$ssth->execute( @$srec );
}


$dbh->disconnect;
	
